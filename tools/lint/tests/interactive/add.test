source [expr {[info exists ::env(TESTS_DIR)] ? "$env(TESTS_DIR)/interactive/ly.tcl" : "ly.tcl"}]

set mdir $::env(YANG_MODULES_DIR)

test add_disable_searchdir_once {add --disable-searchdir} {
-setup $ly_setup -cleanup $ly_cleanup -constraints {!ctest} -body {
    ly_cmd "add $mdir/modimp-cwd.yang"
    ly_cmd "clear"
    ly_cmd_err "add -D $mdir/modimp-cwd.yang" "not found in local searchdirs"
}}

test add_disable_searchdir_twice {add -D -D} {
-setup $ly_setup -cleanup $ly_cleanup -constraints {!ctest} -body {
    ly_cmd "add $mdir/ietf-ip.yang"
    ly_cmd "clear"
    ly_cmd_err "add -D -D $mdir/ietf-ip.yang" "Loading \"ietf-interfaces\" module failed."
}}

test add_with_feature {Add module with feature} {
-setup $ly_setup -cleanup $ly_cleanup -body {
    ly_cmd "add --feature modfeature:ftr2 $mdir/modfeature.yang"
    ly_cmd "feature -a" "modfeature:\r\n\tftr1 \\(off\\)\r\n\tftr2 \\(on\\)"
}}

cleanupTests
