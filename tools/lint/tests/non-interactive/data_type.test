source [expr {[info exists ::env(TESTS_DIR)] ? "$env(TESTS_DIR)/non-interactive/ly.tcl" : "ly.tcl"}]

set mdir "$::env(YANG_MODULES_DIR)"
set ddir "$::env(TESTS_DIR)/data"

test data_type_data {data --type data} {
    ly_cmd "-t data $mdir/modconfig.yang $ddir/modconfig.xml"
} {}

test data_type_config {data --type config} {
    ly_cmd_err "-t config $mdir/modconfig.yang $ddir/modconfig.xml" "Unexpected data state node \"lff\""
    ly_cmd "-t config $mdir/modconfig.yang $ddir/modconfig2.xml"
} {}

test data_type_get {data --type get} {
    ly_cmd_err "-t data $mdir/modleafref.yang $ddir/modleafref2.xml" "Invalid leafref value"
    ly_cmd "-t get $mdir/modleafref.yang $ddir/modleafref2.xml"
} {}

test data_type_getconfig_no_state {No state node for data --type getconfig} {
    ly_cmd_err "-t getconfig $mdir/modconfig.yang $ddir/modconfig.xml" "Unexpected data state node \"lff\""
    ly_cmd "-t getconfig $mdir/modconfig.yang $ddir/modconfig2.xml"
} {}

test data_type_getconfig_parse_only {No validation performed for data --type getconfig} {
    ly_cmd_err "-t data $mdir/modleafref.yang $ddir/modleafref2.xml" "Invalid leafref value"
    ly_cmd "-t getconfig $mdir/modleafref.yang $ddir/modleafref2.xml"
} {}

test data_type_edit_no_state {No state node for data --type edit} {
    ly_cmd_err "-t edit $mdir/modconfig.yang $ddir/modconfig.xml" "Unexpected data state node \"lff\""
    ly_cmd "-t edit $mdir/modconfig.yang $ddir/modconfig2.xml"
} {}

test data_type_edit_parse_only {No validation performed for data --type edit} {
    ly_cmd_err "-t data $mdir/modleafref.yang $ddir/modleafref2.xml" "Invalid leafref value"
    ly_cmd "-t edit $mdir/modleafref.yang $ddir/modleafref2.xml"
} {}

test data_type_rpc {Validation of rpc-statement by data --type rpc} {
    ly_cmd_err "-t rpc $mdir/modleaf.yang $ddir/modleaf.xml" "Missing the operation node."
    ly_cmd "-t rpc $mdir/modrpc.yang $ddir/modrpc.xml"
} {}

test data_type_rpc_reply {Validation of rpc-reply by data --type reply} {
    ly_cmd_err "-t rpc $mdir/modleaf.yang $ddir/modleaf.xml" "Missing the operation node."
    ly_cmd "-t reply $mdir/modrpc.yang $ddir/modrpc_reply.xml"
} {}

test data_type_rpc_action {Validation of action-statement by data --type rpc} {
    ly_cmd_err "-t rpc $mdir/modleaf.yang $ddir/modleaf.xml" "Missing the operation node."
    ly_cmd "-t rpc $mdir/modaction.yang $ddir/modaction.xml"
} {}

test data_type_rpc_action_reply {Validation of action-reply by data --type reply} {
    ly_cmd_err "-t rpc $mdir/modleaf.yang $ddir/modleaf.xml" "Missing the operation node."
    ly_cmd "-t reply $mdir/modaction.yang $ddir/modaction_reply.xml"
} {}

test data_type_notif {Validation of notification-statement by data --type notif} {
    ly_cmd_err "-t notif $mdir/modleaf.yang $ddir/modleaf.xml" "Missing the operation node."
    ly_cmd "-t notif $mdir/modnotif.yang $ddir/modnotif.xml"
    ly_cmd "-t notif $mdir/modnotif.yang $ddir/modnotif2.xml"
} {}

cleanupTests
